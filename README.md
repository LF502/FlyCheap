# FlyCheap
**Flight Tickets Price Statistics and Analysis**

All folders' names are the data collecting date. A very beginning project :D

# 流程与功能说明
## 数据收集－CtripCrawler

### 特性

- 单线程
- 代理池
- 防丢包
- 忽略集
- 矩阵化
- 定日期
- 带格式

### 缺点

- 爬取慢（一天、一个城市对、所有往返航班：平均用时约3秒，高密度航线不超过8秒）
- 忽略共享航班和有经停的航班

### 输出

- **文件夹**：起始爬取航班日期 / 收集日期
- **文件名**：航线（ ~ 代表双向， - 代表单向）
- **表头**：航班日期、星期、航司、机型、出发到达机场及时刻、价格、折扣

### 爬取计划

- [x] 2022年春节期间、春节后，具有地域代表性的航班数据（2022年1月28日已完成－一次足够）
- [ ] **2022年2月17日以后30日部分客流较高（2019年旅客吞吐量前100名）城市间航班数据（2022年1月21日起开始，作为项目初始数据）**
- [ ] **2022年3月29日以后45日部分客流较高（2019年旅客吞吐量前100名）城市间航班数据（2022年2月12日起开始，提前天数不超过45天）**
- [ ] 项目建模、训练、优化等工作完成后的测试和验证用例

## 数据重构－Rebuilder

### 特性

- 使用 pandas 数据结构
- 加载数据较快
- 处理速度随数据量和数据复杂度变化

### 数据重构功能

#### 数据整合（merge）

- [x] 数据总集，整合所有收集的航班原始信息

#### 总览（overview）

- [x] **航司**：按时刻、航线，总览密度与系数；按起飞机场总览航班数量
- [x] **航线**：按日期、提前天数，总览均值和标准差；按时刻总览密度与系数
- [x] **日期**：按航线，以收集日期或航线日期，总览每日折扣均值

### 附加功能

- 四种数据导入方式
- 整合数据的重复利用

## 数据预处理－Preprocessor

### 折扣影响

——航线距离与机票全价成正比，可通过 价格 / 折扣 换算。在此不研究价格，而是机票折扣。

- 同一日期、同一航线中：航司（包括航司性质和航司间竞争）、时刻影响
- 同一时段、同一航线中：航司（包括航司性质和航司间竞争）、日期（包括星期和节假日）影响
- 同一日期、同一时段中：航司（包括航司性质和航司间竞争）、航线（起飞到达机场）

### 影响因素（按影响程度排序）

#### 航线

- **城市对**：城市间地级、城市地理位置、旅游城市
- **客流**：起飞到达机场（受日期影响的）进出港客流量
- **竞争**：运营此航线的航司数量
- **密度**：航线的平均日密度和时刻密度

#### 日期

- **月份**：距航班起飞一周以外时间，次月票价往往高于本月票价
- **距航班起飞时间**：距航班起飞天数小于7天时价格呈现大幅上涨趋势
- **星期几**：每周五出现票价小高峰
- **春节**：春节前后东西向客流差异导致价格变化反常；且除夕、春节期间票价极低
- **假期**：将寒暑假、短长假（清明、五一、端午、中秋、国庆等）划为假期，所有票价有所上升

#### 时段

- **起飞时间**：**最早班**（最低） - **早上**（大升） - **中午**（最高） - **下午**（略降） - **晚上**（大降） - **最晚班**（最低）
- **时段密度**：该航线在本时段上的密度将影响不同航司定价

#### 航司

- **全服务 - 混合 - 廉价**：票价越来越低；但有例外现象
- **竞争**：同时段 / 同日期航司越多，竞争越激烈，廉价航司越便宜；反之则差异不大

### 影响较小或难以预测因素

- **机型**：非主导因素，随航班所在航线、日期、时刻、航司变化


### 量化影响程度

#### 航线主导：固有特征（航线性质）

- **起降机场**：One-hot。通过机场系数表达：机场国际枢纽、大型枢纽、中型机场、支线机场
- **城市级别**：One-hot。通过级别系数表达：一线、准一线、二线等
- **地理位置**：One-hot。通过城市对距东海岸距离系数之差表达相对远近
- **航线客流**：One-hot。通过起降机场系数之和表达：干线、小干线、支线等
- **时段密度**：One-hot。通过同时段的航班密度表达：高、中、低
- **日期密度**：One-hot。通过同日期的航班密度表达：高、中、低

#### 显著程度：可变特征（随航线而变）

- **星期、距航班起飞天数**：任意、非假期期间的航线，影响明显。
- **假期**：连接内陆与沿海或连接不同级别城市的航线，以及旅游航线，影响明显。其余航线不明显。
- **航司**：高客流和高密度航线，对廉价航司的影响明显。其余航线不明显。
- **竞争**：高客流和高密度航线（干线和小干线），竞争越多，对廉价航司的折扣影响越明显；竞争越少，各个航司在该时段内折扣越趋同。其余航线不明显。
- **时段**：高客流或高密度航线，折扣影响明显。低客流或低密度航线不明显。

#### 量化形式



## 其他功能

### 自动化任务（Routine）

- 可实现多机分配范围后同时爬取
- 生成原数据表格后，加入待整合数据集
- 文件分类打包、整合数据集

### 爬取记录（Log）

- 记录终端输出的提示文字及输出时间
- 记录忽略或异常的城市对

# 尚未实现的功能

- [ ] 数学建模实验
- [ ] 机器学习实验
- [ ] 用户UI